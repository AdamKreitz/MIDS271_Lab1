---
title: "W271 Group Lab 1"
subtitle: "Investigating the 1986 Space Shuttle Challenger Accident"
author: "Adam Kreitzman, Hailee Schuele, Lee Perkins, Paul Cooper"
output: bookdown::pdf_document2
fontsize: 11pt
geometry: margin=1in
---

```{r, include=F}
library(tidyverse)
library(lmtest)
library(ggplot2)
library(car)
```

\newpage

```{=tex}
\begin{abstract} 
This report will, indeed, be abstract. No, instead, describe your goals your approach, and what you learn.
\end{abstract}
```
# Introduction

PLACE INTRODUCTION HERE

## Research question

PLACE RESEARCH QUESTION HERE

# Data

```{r, include=F}
# df <- read.csv("../data/raw/challenger.csv")
challenger <- read.csv("/home/rstudio/workspace/mnt/271/labs/MIDS271_Lab1/Lab_1/data/raw/challenger.csv")
```

PLACE DATA PARAGRAPH HERE. MAKE SURE THEY SATISFY THE ABOVE TASKS

## Description

PLACE DATA DESCRIPTION PARAGRAPH HERE. MAKE SURE THEY SATISFY THE ABOVE TASKS

## Key Features

EXPLORATORY DATA ANALYSIS PT1 GOES HERE

```{r scatter plots of Temp vs O.ring and Pressure vs O.ring, echo=F, fig.align="center"}
# i combined the plots here because they were the same, and it saves space.
# if we do not want this just delete everything after the `|` and uncomment the plot below
plot(challenger$Temp, challenger$O.ring, pch = 16, xlab = "Temperature", ylab = "O.ring") | plot(challenger$Pressure, challenger$O.ring, pch = 16, xlab = "Pressure", ylab = "O.ring")
```

EXPLORATORY DATA ANALYSIS PT2 GOES HERE

```{r scatter plot of Pressure vs O.ring, echo=F, fig.align="center"}
# plot(df$Pressure, df$O.ring, pch = 16, xlab = "Pressure", ylab = "O.ring")
```

EXPLORATORY DATA ANALYSIS PT3 GOES HERE

```{r, echo=F, fig.align="center"}
# I am copying the code from the Report-Analysis folder.
# these plots do not look like the plot on the Doc.
# is this right???

# hist(df$Temp, xlab = "Temperature", main = "Histogram of Temperature")
# hist(df$Pressure, xlab = "Pressure", main = "Histogram of Pressure")
```

EXPLORATORY DATA ANALYSIS PT4 GOES HERE

```{r boxplot of Temp, echo=F, fig.align="center"}
boxplot(challenger$Temp ~ challenger$O.ring, xlab = "O.ring", ylab = "Temperature",
        main = "Box plot of Temperature by O.ring")

# To me it seemed like the Temp boxplot was the most meaningful
# uncomment if you think it should be included
# boxplot(df$Pressure ~ df$O.ring, xlab = "O.ring", ylab = "Pressure",
#         main = "Box plot of Pressure by O.ring")
```

EXPLORATORY DATA ANALYSIS PT5 GOES HERE

```{r heatmap of correlation matrix, echo=F, fig.align="center"}
heatmap(cor(challenger[, c("O.ring", "Temp", "Pressure")]),
        col = colorRampPalette(c("blue", "white", "red"))(100),
        main = "Heatmap of Correlation Matrix")
```

EXPLORATORY DATA ANALYSIS PT6 GOES HERE

# Analysis

## Reproducing Previous Analysis

PLACE REPRODUCING PREVIOUS ANALYSIS PT1 HERE

```{r model}
# Logistic regression from the paper
mod_full <- glm(cbind(O.ring, 6 - O.ring) ~ Temp + Pressure, data = challenger, family = binomial(link = "logit"))
summary(mod_full)
```

PLACE REPRODUCING PREVIOUS ANALYSIS PT2 HERE

PLACE REPRODUCING PREVIOUS ANALYSIS LIKELIHOOD RATIO TEST HERE

```{r likelihood ratio tests}
Anova(mod_full, test = "LR")
```

PLACE REPRODUCING PREVIOUS ANALYSIS PRESSURE DEBATE HERE

## Confidence Intervals

PLACE CONFIDENCE INTERVALS PT1 HERE. MAKE SURE THEY ALL SATISFY THE ABOVE TASKS

```{r confidence intervals}
# Estimate model with only temperature
mod_temp <- glm(cbind(O.ring, 6 - O.ring) ~ Temp, data = challenger, family = binomial(link = "logit"))

# Estimate model with temperature and quadratic term
mod_temp_quad <- glm(cbind(O.ring, 6 - O.ring) ~ Temp + I(Temp^2), data = challenger, family = binomial(link = "logit"))

# Determine if quadratic term is important to the model
anova(mod_temp, mod_temp_quad, test = "Chisq")
```

PLACE CONFIDENCE INTERVALS PT2 HERE.

PLACE CONFIDENCE INTERVALS PLOTS PT1 HERE.

```{r confidence interval plot1, echo=F, fig.align="center"}
# The plots in the code didn't feel like they were the same as in the Doc?
```

PLACE CONFIDENCE INTERVALS PLOTS PT2 HERE.

```{r confidence interval plot 2, echo=F, fig.align="center"}
# where is the plot code? Also, should we just show it side by side with the previous confidence interval plot?
```

PLACE CONFIDENCE INTERVALS PLOTS PT3 HERE.

## Bootstrap Confidence Intervals

PLACE BOOTSTRAP CONFIDENCE INTERVALS PT1 HERE. MAKE SURE THEY ALL SATISFY THE ABOVE TASKS

```{r bootstrap confidence interval plot, echo=F, fig.align="center"}
# Set the number of bootstrap samples
B <- 1000

# Initialize a matrix to store the bootstrap predictions
temps <- 10:100
bootstrap_preds <- matrix(NA, nrow = B, ncol = length(temps))
colnames(bootstrap_preds) <- temps

# Run the bootstrap
set.seed(123)  # for reproducibility
for (b in 1:B) {
  # Resample the data
  bootstrap_data <- challenger[sample(nrow(challenger), replace = TRUE), ]
  # Fit the model to the bootstrap data
  bootstrap_model <- glm(cbind(O.ring, 6 - O.ring) ~ Temp, 
                         data = bootstrap_data, family = binomial)
  # Compute predictions at each temperature
  for (temp in temps) {
    bootstrap_preds[b, as.character(temp)] <- 
      predict(bootstrap_model, newdata = data.frame(Temp = temp), type = "response")
  }
}

# Compute 90% confidence intervals
ci_lower <- apply(bootstrap_preds, 2, function(x) quantile(x, 0.05))
ci_upper <- apply(bootstrap_preds, 2, function(x) quantile(x, 0.95))

# Combine results into a data frame
results <- data.frame(
  Temperature = temps,
  Lower_CI = ci_lower,
  Upper_CI = ci_upper
)

ggplot(results, aes(x = Temperature)) +
  geom_ribbon(aes(ymin = Lower_CI, ymax = Upper_CI), fill = "grey80") +
  geom_line(aes(y = (Lower_CI + Upper_CI) / 2), color = "red") +
  labs(y = "Predicted Probability of O-ring Failure", 
       title = "Predicted Probabilities with 90% Confidence Intervals") +
  theme_minimal()
```

PLACE BOOTSTRAP CONFIDENCE INTERVALS PT2 HERE

## Alternative Specification

PLACE ALTERNATIVE SPECIFICATION PT1 HERE. MAKE SURE THEY SATISFY THE ABOVE TASK

```{r qq plot, echo=F, fig.align="center"}
# Should we show the code for the linear_model?

# Define a linear model
linear_model <- lm(cbind(O.ring, 6 - O.ring) ~ Temp, data = challenger)
summary(linear_model)

# Check residuals
resid_plot <- plot(resid(linear_model), pch = 16,
                   main = "Residuals vs Fitted Values",
                   xlab = "Fitted Values",
                   ylab = "Residuals")

qqnorm(resid(linear_model))
qqline(resid(linear_model))
```

PLACE ALTERNATIVE SPECIFICATION PT2 HERE

# Conclusions

PLACE CONCLUSION HERE